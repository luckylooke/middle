{"version":3,"sources":["webpack:///webpack/universalModuleDefinition?5ca6","webpack:///webpack/bootstrap 749da561f0cffcd32b2b?5da6","webpack:///./src/middle.src.js?5da0"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA,qBAAoB;AACpB;AACA;;AAEA;AACA,qCAAoC;AACpC;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,oBAAmB;AACnB;AACA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,YAAW;;AAEX;;AAEA,YAAW;AACX;;AAEA;;AAEA;AACA;;AAEA,OAAM,uBAAuB;;AAE7B;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA","file":"middle.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"Middle\", [], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Middle\"] = factory();\n\telse\n\t\troot[\"Middle\"] = factory();\n})(this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 749da561f0cffcd32b2b","'use strict';\n\nexport default class Middle {\n\n\tconstructor( cb, ctx, init ) {\n\n\t\tif ( !init ) {\n\n\t\t\tlet middleInstance = new Middle( cb, ctx, 'mi' ),\n\t\t\t\tmiddleRun = middleInstance.run,\n\t\t\t\tuseInstance = new Middle( middleInstance.use, middleInstance, 'ui' ),\n\t\t\t\tuseInstanceRun = useInstance.run;\n\n\t\t\tuseInstanceRun.use = useInstance.use.bind( useInstance );\n\t\t\tthis.setProps( useInstanceRun, useInstance );\n\n\t\t\tmiddleRun.use = useInstanceRun;\n\t\t\tthis.setProps( middleRun, middleInstance );\n\t\t\treturn middleRun;\n\t\t}\n\n\t\tif ( typeof cb === 'function' )\n\n\t\t\tthis.callback = (ctx === 'middleInstance') ? cb.bind( this ) : (ctx !== undefined ? cb.bind( ctx ) : cb);\n\n\t\telse\n\n\t\t\tthis.callback = function () {\n\t\t\t\treturn arguments\n\t\t\t};\n\n\t\tthis.run = () => { // must be inside constructor because we need to pass instance\n\t\t\treturn this.callRunner( arguments, this );\n\t\t};\n\n\t\tthis._stack = [];\n\t\t// this.id = Math.random() + init; // dev: contexts identification\n\t}\n\n\tuse( fn, ctx ) {\n\n\t\tthis._stack.push( ctx !== undefined ? fn.bind( ctx ) : fn );\n\t}\n\n\tstatic callRunner( args, ctx ) {\n\n\t\tlet result = new Runner( args, ctx );\n\n\t\tif ( result.__mPrVaPr__ === '__mUnPr__' ) // mPrVaPr = middlePrimitiveValueProtection, mUnPr = middleUndefinedProtection\n\t\t\treturn undefined;\n\n\t\telse if ( result.__mPrVaPr__ !== undefined )\n\n\t\t\treturn result.__mPrVaPr__;\n\n\t\t//else\n\t\treturn result;\n\t}\n\n\tstatic setProps( to, from ) {\n\n\t\tto._stack = from._stack;\n\t\tto.callback = from.callback;\n\t\tto.middle = from; // access to original instance\n\t}\n}\n\nclass Runner {\n\n\tconstructor( args, ctx ){\n\n\t\tthis._stack = args.callee._stack;\n\t\tthis.callback = args.callee.callback.bind( ctx );\n\n\t\tif ( !this._stack.length )\n\t\t\treturn this.result( this.callback.apply( null, args ) );\n\n\t\tthis._stackIndex = 0;\n\t\tthis._stackLen = this._stack.length;\n\t\treturn this.result( this.next.apply( this, args ) );\n\t}\n\n\tnext() {\n\n\t\tif ( this._stackIndex < this._stackLen ) {\n\n\t\t\tthis._stackIndex++;\n\t\t\treturn this._stack[ this._stackIndex - 1 ]\n\t\t\t\t.bind( null, this.next.bind( this ) )\n\t\t\t\t.apply( null, arguments );\n\t\t}\n\t\telse {\n\n\t\t\treturn this.callback.apply( null, arguments );\n\t\t}\n\t}\n\n\tresult( val ) {\n\n\t\tif ( typeof val === 'object' )\n\n\t\t\treturn val;\n\n\t\telse if ( val !== undefined )\n\n\t\t\treturn { __mPrVaPr__: val };\n\n\t\telse\n\n\t\t\treturn { __mPrVaPr__: '__mUnPr__' };\n\t}\n\n}\n\n// middle ES6 decorator, usage: @middle\nexport function middle( target, key, descriptor ) {\n\n\tlet { writable, enumerable } = descriptor;\n\n\treturn {\n\t\tget: function () {\n\n\t\t\tlet middleInstance = new Middle( descriptor.value, this );\n\t\t\tObject.defineProperty( this, key, {\n\t\t\t\tvalue: middleInstance,\n\t\t\t\twritable: writable,\n\t\t\t\tenumerable: enumerable\n\t\t\t} );\n\n\t\t\treturn middleInstance;\n\t\t}\n\t};\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/middle.src.js\n// module id = 0\n// module chunks = 0 1"],"sourceRoot":""}