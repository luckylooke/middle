!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Middle",[],e):"object"==typeof exports?exports.Middle=e():t.Middle=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){!function(e){"use strict";function i(t,n,o){if(!(this instanceof i))throw new Error("Middle needs to be called with the new keyword");if(!o){var s=new i(t,n,"init"),r=s.run.bind(s),c=new i(s.use,s,"init"),d=c.run.bind(c);return d.use=c.use.bind(c),r.use=d,r.middle=s,r}"function"==typeof t?this.callback=t.bind("middleInstance"==n?this:n!==e?n:null):this.callback=function(){},this._stack=[],this.id=Math.random()}function n(t,e,i){return this._stack=t,this.callback=e,this._stack.length?(this._stackIndex=0,this._stackLen=this._stack.length,this.result(this.next.apply(this,i))):this.result(this.callback.apply(null,i))}i.prototype.run=function(){var t=new n(this._stack,this.callback,arguments);return"__middleUndefinedProtection__"===t.__middlePrimitiveValueProtection__?e:t.__middlePrimitiveValueProtection__!==e?t.__middlePrimitiveValueProtection__:t},i.prototype.use=function(t,i){this._stack.push(i!==e?t.bind(i):t)},n.prototype.next=function(){return this._stackIndex<this._stackLen?(this._stackIndex++,this._stack[this._stackIndex-1].bind(null,this.next.bind(this)).apply(null,arguments)):this.callback.apply(null,arguments)},n.prototype.result=function(t){return"object"==typeof t?t:t!==e?{__middlePrimitiveValueProtection__:t}:{__middlePrimitiveValueProtection__:"__middleUndefinedProtection__"}},t.exports=i}()}])});
//# sourceMappingURL=middle.min.js.map